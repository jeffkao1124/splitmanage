<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1" />
    <title>查帳小幫手</title>
    <script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script>
        function print_value() {

            document.getElementById("result") = document.getElementById("number").value
        }
</script>
<script>
	function initializeApp(data) {  //初始化LIFF
        var userid = data.context.userId;
        var groupid = data.context.groupId; //取得ID
        document.getElementById('post_groupID').value = groupid;

	}
	function closewin() {

        liff.closeWindow();


	}
    function pushMsg() {
        var msg = '刪除';
        liff.sendMessages([  //推播訊息
			{ type: 'text',
			  text: msg
			},
		])
			.then(() => {
			alert('已刪除所有資料');
            window.location.reload();
			});


    }

	$(document).ready(function () {
    
		liff.init(function (data) {  //初始化LIFF
            initializeApp(data);
		});
		
        $('#sure').click(function (e) {  //按下確定鈕
            
			closewin(); 
		});
        $('#delete').click(function (e) {  //按下確定鈕
            
			pushMsg(); 
		});
	});
</script>

</head>
<body style="background-color:#FFEEDD;">
<style>
  .text-background {
    background: white;
    board:50px;
    margin: 0.6em 6%;
    padding: 0.3em;
    border-left: 1em solid black }
</style>

<div align="center">
    <br><img style="float: center" src="https://scontent-tpe1-1.xx.fbcdn.net/v/t1.0-9/118564250_3916210075072856_4538250581291362262_o.jpg?_nc_cat=102&_nc_sid=8024bb&_nc_ohc=pVO1LBE3Ud4AX_-Wo67&_nc_ht=scontent-tpe1-1.xx&oh=e5e38d055d796ff155cec63810e9dec8&oe=5F74AE54" alt="logo" width="110" height="110"/></br><p></p><h3>Welcome to</h3></p><h3><span style="background-color: #914c53; color: #ffffff;">&nbsp Account Mastiff &nbsp</span></h3>
    <br/>
    <p class="text-background" align="left" style="font-size:18px;"><strong> &nbsp目前分帳清單：</strong></p>
    <table width=82% style="border-collapse:collapse; border:2px #FFAF60 solid;" cellpadding="10" border='1'>
        <thead align="center">
            <th>編號</th>
            <th>項目</th>
            <th>金額</th>
            <th>分帳人</th>
        </thead>
        <tbody>
            {% for _data in save_list %}
                <tr>
                    <td align="center">{{ _data.number }}</td>
                    <td>{{ _data.message }}</td>
                    <td>{{ _data.account }}</td>
                    <td>{{ _data.group_num }}</td>
                </tr>
            {% endfor%}
        </tbody>
    </table><br/>
    <p class="text-background" align="left" style="font-size:18px;"><strong> &nbsp代墊與欠款統計：</strong></p>
    {% for list in showlist %}
    <p>{{ list }}</p>
    {% endfor %}
    <p>
        <img src="{{ img }}" style="float: right">
    </p>
    <p><strong>{{ warning }}</strong></p>
    <br/>
    <p class="text-background" align="left" style="font-size:18px;"><strong>&nbsp結算：</strong></p>
    {% for list in settle %}
    <p>{{ list }}</p>
    {% endfor %}
    <br/>
    <p class="text-background" align="left" style="font-size:18px;"><strong>&nbsp編輯：</strong></p>
    <script>
        function deleteOption(list){
            var index=list.selectedIndex;
            var msg = 'delete';
            msg=msg+index;
        if(index>0){        
            liff.sendMessages([  
			{ type: 'text',
			  text: msg
			},
		])
        .then(() => {
			alert('已刪除該筆資料');
            window.location.reload();
			});
        }

            if (index>0)
                list.options[index]=null;

            else
                alert("無資料可以刪除！");
        }
        
        </script>
        
        <form>
        <select id=theList size=5>
            <option value='請選擇'>請選擇</option>
            {% for _data in save_list %}
            <option id="{{ _data.number }}" value="{{ _data.number }}">{{ _data.number }} {{ _data.message }} {{ _data.account }}</option>
            {% endfor %}

        </select>
        <br/><br/>
        <input type="button" value="刪除此筆資料" onclick="deleteOption(theList)"><br>
        </form>
        <br/>
        <input type="button" name="ok" id="delete" value="刪除所有資料"><br>
        <br/>
</div>
</body>
</html>

